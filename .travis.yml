sudo: false
language: haskell
ghc: 7.8
cache:
  directories:
  - $HOME/.ghc
  - $HOME/.cabal
branches:
  only:
  - master
before_install:
    - cd _site/
    - git checkout gh-pages
    - cd ..
install:
- cabal install hakyll
- ghc --make site.hs
script: ./site build
env:
  global:
    secure: prOUp/nvgsMzZRbBxKqNklD1JsCWTgWXbEblCEli7sDYRSbaMgw6HTyu9/iWKhXR+F3EQoBVncjGeKgb5C5M4aaB8hyX17NILOnu0ztm3fOd/fKFCqUsfnXlTQjR2xPD5QjBbXRTs52wKDhGxsDsrjv+bbzo1s4nk2nO9wcNgSo=
machine:
    timezone:
        Europe/Berlin
after_success:
    - git config --global user.email ob@cs.hm.edu
    - git config --global user.name Travis CI
    - cd _site/
    - git add .
    - git commit -m "Update (`date '+%F %T %Z'`)"
    - git push "https://${GH_TOKEN}@github.com/obcode/ob.cs.hm.edu.git" gh-pages

